<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>PlayNFT - The Playground for your NFTs</title>
    <meta content="" name="description" />

    <meta content="nft" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NTBHF6SC72"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-NTBHF6SC72');
    </script>


    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon" />
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet" />

    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet" />
    <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="../assets/css/style.css" rel="stylesheet" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.js"></script>
    <script src="https://kit.fontawesome.com/0a0492e97d.js" crossorigin="anonymous"></script>
    <script
        src="https://www.paypal.com/sdk/js?client-id=Afublr47iUx9od__o9lROJup9U0wx74gtOgqlGi-xPG8hGRUggDp1497DSQTMaAN9hP5FspYXTg9bZu0"></script>

    <script src="https://cdn.tiny.cloud/1/doicvbneaya0gerwmrc6gn0ei4uw3vsk4znmslowgfwri44v/tinymce/5/tinymce.min.js"
        referrerpolicy="origin"></script>

    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/moralis-v1@latest/dist/moralis.min.js"></script>

    <script>
        tinymce.init({
            selector: 'textarea',
            menubar: false
        });
    </script>

    <!-- Page Components -->
    <script src="../components/header.js" type="text/javascript"></script>
    <script src="../components/footer.js" type="text/javascript"></script>
</head>

<body>
    <!-- ======= Header ======= -->
    <header-component alternate_header="true"></header-component>
    <!-- End Header -->

    <main id="main">
        <!-- ======= Streamers Section ======= -->
        <section id="section-streamers" class="gamers">
            <div class="container">
                <header class="section-header">
                    <h2>Creator NFTs</h2>
                    <p>NFT Inventory</p>
                </header>

                <div class="wizard">
                    <div class="wizard-inner">
                        <div class="connecting-line"></div>
                        <ul class="nav nav-tabs" role="tablist">
                            <li role="presentation" class="nav-item active">
                                <a title="1. Twitch Login" class="nav-link" id="nav-twitch-login" role="tab"
                                    data-bs-toggle="tab" aria-controls="twitch-login" href="#list-twitch-login">
                                    <span class="round-tab">
                                        <i class="fas fa-user-tie" style="font-size: 3.7vh"></i>
                                    </span>
                                </a>
                            </li>
                            <li role="presentation" class="nav-item disabled">
                                <a title="2. NFT Inventory" class="nav-link" id="nav-twitch-nfts" role="tab"
                                    data-bs-toggle="tab" aria-controls="twitch-nfts" href="#list-twitch-nfts">
                                    <span class="round-tab"><i class="fas fa-sd-card"
                                            style="font-size: 3.7vh"></i></span>
                                </a>
                            </li>
                            <li role="presentation" class="nav-item disabled">
                                <a title="3. Connect Wallet" class="nav-link" id="nav-twitch-wallet" role="tab"
                                    data-bs-toggle="tab" aria-controls="twitch-wallet" href="#list-twitch-wallet">
                                    <span class="round-tab"><i class="fas fa-wallet"
                                            style="font-size: 3.7vh"></i></span>
                                </a>
                            </li>
                            <li role="presentation" class="nav-item disabled">
                                <a title="4. Blockchain Confirmations" class="nav-link" id="nav-twitch-review"
                                    role="tab" data-bs-toggle="tab" aria-controls="twitch-review"
                                    href="#list-twitch-review">
                                    <span class="round-tab"><i class="fas fa-link" style="font-size: 3.7vh"></i></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="row spacer">&nbsp;</div>

                <div class="row">
                    <div class="col-12">
                        <div class="tab-content" id="nav-tabContent">
                            <div class="tab-pane fade show active" id="list-twitch-login" role="tabpanel"
                                aria-labelledby="nav-twitch-login">
                                <div class="col-lg-12">
                                    <h4>Creator Login</h4>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="list-twitch-nfts" role="tabpanel"
                                aria-labelledby="nav-twitch-nfts">
                                <div class="col-md-12">
                                    <div class="panel panel-primary" id="twitch-nfts-panel">
                                        <div class="panel-heading">
                                            <h4>Purchased NFTs</h4>
                                        </div>
                                        <div style="text-align: end; padding-bottom: 20px;">

                                        </div>
                                        <div class="panel-body">
                                            <ul class="list-group" id="twitch-nfts">

                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="list-twitch-wallet" role="tabpanel"
                                aria-labelledby="nav-twitch-wallet">
                                <div class="col-lg-12">
                                    <h4>Choose Blockchain for Minting</h4>
                                    <form id="twitch-scan-form" action="#" method="post">
                                        <input type="hidden" name="walletMode" value="creators" />

                                        <div class="gy-4">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-enj" value="enj" checked>
                                                <label class="form-check-label" for="creators-chain-enj"><img
                                                        style="width:50px;padding-bottom: 10px;"
                                                        src="/assets/img/enjin-coin-enj-logo.svg" alt="Enjin" /></label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-stx" value="stx">
                                                <label class="form-check-label" for="creators-chain-stx"><img
                                                        style="width:50px;padding-bottom: 10px;"
                                                        src="/assets/img/stacks-stx-logo.svg" alt="Stacks" /></label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-solana" value="solana">
                                                <label class="form-check-label" for="creators-chain-solana"><img
                                                        style="width:50px;padding-bottom: 10px;"
                                                        src="/assets/img/solana-sol-logo.svg" alt="Solana" /></label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-telos" value="telos">
                                                <label class="form-check-label" for="creators-chain-telos"><img
                                                        style="width:50px;padding-bottom: 10px;"
                                                        src="/assets/img/telos.svg" alt="Telos" /></label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-eth" value="eth">
                                                <label class="form-check-label" for="creators-chain-eth"><img
                                                        style="height:50px;padding-bottom: 10px;"
                                                        src="/assets/img/ethereum-eth-logo.svg" alt="Ethereum" /></label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="creators-chain"
                                                    id="creators-chain-evmos" value="evmos">
                                                <label class="form-check-label" for="creators-chain-evmos"><img
                                                        style="width:50px;padding-bottom: 10px;"
                                                        src="/assets/img/evmos.svg" alt="Evmos" /></label>
                                            </div>
                                        </div>
                                        <div class="row spacer-20">&nbsp;</div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-enj">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddress" id="twitch-walletAddress"
                                                    class="form-control wallet-address"
                                                    placeholder="Ethereum Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">
                                                <a href="https://enjin.io/software/wallet" target="_blank">Download the
                                                    Enjin Wallet</a>
                                            </div>
                                        </div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-stx">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddressStacks"
                                                    id="twitch-walletAddressStacks" class="form-control wallet-address"
                                                    placeholder="Stacks Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">

                                            </div>
                                        </div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-solana">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddressSolana"
                                                    id="twitch-walletAddressSolana" class="form-control wallet-address"
                                                    placeholder="Solana Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">

                                            </div>
                                        </div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-telos">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddressTelos"
                                                    id="twitch-walletAddressTelos" class="form-control wallet-address"
                                                    placeholder="Telos Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">
                                                <button id="creators-tlos-wallet-connect" class="btn btn-primary" type="button">
                                                    Connect with Metamask
                                                  </button>
                                            </div>
                                        </div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-eth">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddressEth"
                                                    id="twitch-walletAddressEth" class="form-control wallet-address"
                                                    placeholder="Ethereum Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">
                                                <button id="creators-eth-wallet-connect" class="btn btn-primary" type="button">
                                                    Connect with Metamask
                                                  </button>
                                            </div>
                                        </div>
                                        <div class="row gy-4 chain-wallet" id="creators-wallet-evmos">
                                            <div class="col-md-6">
                                                <input type="text" name="walletAddressEvmos"
                                                    id="twitch-walletAddressEvmos" class="form-control wallet-address"
                                                    placeholder="Evmos Wallet Address" required />
                                            </div>
                                            <div class="col-md-6 text-end">
                                                <button id="creators-evmos-wallet-connect" class="btn btn-primary" type="button">
                                                    Connect with Metamask
                                                  </button>
                                            </div>
                                        </div>
                                        <div class="row spacer-20">&nbsp;</div>
                                        <div class="row gy-4">
                                            <div class="col-md-12 text-center">
                                                <div id="twitch-error" style="color: red"></div>
                                                <button id="twitch-scan-wallet" class="btn-read-more" type="submit">
                                                    Mint NFT!
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="list-twitch-review" role="tabpanel"
                                aria-labelledby="nav-twitch-review">
                                <div class="col-md-12">
                                    <div class="panel panel-primary" id="twitch-review-panel">
                                        <div class="panel-heading">
                                            <h4>Blockchain Confirmation</h4>
                                            <p class="section-header"></p>
                                        </div>
                                        <div class="panel-body">
                                            <div class="flex-shrink-0 text-center">
                                                <p class="game-icon">
                                                    Your request has been sent to the blockchain. The NFT will be
                                                    arriving to your wallet shortly!<br><br>
                                                    Thank you for using PlayNFT
                                                </p>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- ======= End Streamers Section ======= -->
    </main>

    <!-- ======= Footer ======= -->
    <footer-component></footer-component>
    <!-- End Footer -->

    <!-- Vendor JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>
    <script src="../assets/vendor/aos/aos.js"></script>
    <script src="../assets/vendor/php-email-form/validate.js"></script>
    <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="../assets/vendor/purecounter/purecounter.js"></script>
    <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>

    <!-- Template Main JS File -->
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/playnft.js"></script>

    <script id="twitch-nfts-template" type="text/x-jquery-tmpl">
        <li id="streamers_nft_${id}" class="list-group-item d-flex list-group-item-action streamers-nft-item">
          <div class="flex-shrink-0 game-icon">
            <img
              src="https://playnft.s3.amazonaws.com/nfts/${streamerId}/${id}/icon.png"
              class="img-fluid"
              alt="${name}"
            />
          </div>
          <div class="flex-grow-1 ms-3">
            <strong>${name}</strong>
            <p>Creator: ${streamer}<br/>
            Date Acquired: ${date}<br/>
            {{if claimed == 1 }}
            Chain Minted: ${chain}<br/>
            {{/if}}
        </p>
            <div class="actions">
              {{if supply > 0 }}
                <a href="#" id="twitch-nfts-select" class="btn-details-select" data-id="${transactionId}" data-streamerid="${streamerId}" >Mint NFT</a>
              {{/if}}
            </div>
          </div>
        </li>
      </script>
</body>
<script>
    var streamerID = "";
    var transactionID = "";
    var walletID = "";
    var buyerID = "";

    $(document).ready(function () {

        var hash = window.location.hash.substring(1);
        var params = {}
        hash.split('&').map(hk => {
            let temp = hk.split('=');
            params[temp[0]] = temp[1]
        });

        console.log(params)


        //Wizard
        $('a[data-bs-toggle="tab"]').on("show.bs.tab", function (e) {
            var $target = $(e.target);

            if ($target.parent().hasClass("disabled")) {
                console.log($target.parent());
                return false;
            }
        });
    });

    $(document).on("click", "#twitch-nfts-select", function () {

        transactionID = $(this).data('id');
        streamerID = $(this).data('streamerid');

        openTab("#nav-twitch-wallet");
    });

    $("#twitch-scan-form").on("submit", function (e) {
        e.preventDefault();
        $('#twitch-error').empty();
        console.log(chainID)

        if ($('input[name="creators-chain"]:checked').val() == "enj") {
            walletID = $('#twitch-walletAddress').val();
        }

        if ($('input[name="creators-chain"]:checked').val() == "stx") {
            walletID = $('#twitch-walletAddressStacks').val();
        }

        if ($('input[name="creators-chain"]:checked').val() == "solana") {
            walletID = $('#twitch-walletAddressSolana').val();
        }

        if ($('input[name="creators-chain"]:checked').val() == "telos") {
            walletID = $('#twitch-walletAddressTelos').val();
        }

        if ($('input[name="creators-chain"]:checked').val() == "eth") {
            walletID = $('#twitch-walletAddressEth').val();
        }

        if ($('input[name="creators-chain"]:checked').val() == "evmos") {
            walletID = $('#twitch-walletAddressEvmos').val();
        }

        let formData = { transactionId: transactionID, streamerId: streamerID, wallet: walletID, buyerId: buyerID, chain: chainID };
        console.log(formData)
        $.ajax({
            url:
                "https://api.playnft.io/mintnft",
            type: "POST",
            crossDomain: true,
            data: JSON.stringify(formData),
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                console.info(data);
                let response = jQuery.parseJSON(data);
                console.info(response);
                if (response && response[0].error) {
                    $('#twitch-error').html(response[0].error);
                } else {
                    openTab("#nav-twitch-review");
                }
            },
        });
    });


    function openTab(tabId) {
        let active = $(".wizard .nav-tabs li.active");
        console.log(active)
        active.addClass("completed");
        active.removeClass("active");
        let next = active.next();

        next.addClass("active");
        next.removeClass("disabled");

        var nextTab = document.querySelector(tabId);
        var tab = new bootstrap.Tab(nextTab);
        tab.show();
    }

    function GetTwitchInventory() {
        startLoading()
        let formData = { streamer_id: buyerID, mode: "buyer" };
        console.log(formData)
        $.ajax({
            url:
                "https://api.playnft.io/getnfts",
            type: "POST",
            crossDomain: true,
            data: JSON.stringify(formData),
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                console.info(data);
                let response = jQuery.parseJSON(data);
                stopLoading()
                $("#twitch-nfts").empty();

                response.forEach(function (item) {
                    var date = new Date(item.date)
                    var dateString = date.toLocaleString('en-US', {
                        day: 'numeric', // numeric, 2-digit
                        year: 'numeric', // numeric, 2-digit
                        month: 'long', // numeric, 2-digit, long, short, narrow
                        hour: 'numeric', // numeric, 2-digit
                        minute: 'numeric', // numeric, 2-digit
                        second: 'numeric', // numeric, 2-digit
                    })

                    let chain = "Pending";
                    if (item.claimed == 1) {
                        item.supply = 0;
                        if (item.chain == "enj") chain = "Enjin Jumpnet";
                        if (item.chain == "stx") chain = "Stacks";
                        if (item.chain == "solana") chain = "Solana";
                        if (item.chain == "telos") chain = "Telos";
                        if (item.chain == "eth") chain = "Ethereum";
                        if (item.chain == "evmos") chain = "Evmos";
                    }

                    let game_content = { id: item.id, transactionId: item.transactionId, name: item.name, date: dateString, streamer: item.streamer, streamerId: item.streamerId, supply: item.supply, claimed: item.claimed, chain: chain };
                    $("#twitch-nfts-template")
                        .tmpl(game_content)
                        .appendTo("#twitch-nfts");
                });

                openTab("#nav-twitch-nfts");
            },
        });
    }
</script>

</html>